# Public_159

# CÃC GIáº¢I THUáº¬T MÃƒ HÃ“A KHÃ“A Báº¤T Äá»I Xá»¨NG

## KhÃ¡i quÃ¡t vá» mÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng

MÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng, Ä‘Ã´i khi Ä‘Æ°á»£c gá»i lÃ  mÃ£ hÃ³a khÃ³a cÃ´ng khai sá»­ dá»¥ng má»™t cáº·p khÃ³a cho quÃ¡ trÃ¬nh mÃ£ hÃ³a vÃ  giáº£i mÃ£. Trong cáº·p khÃ³a, khÃ³a cÃ´ng khai Ä‘Æ°á»£c sá»­ dá»¥ng cho mÃ£ hÃ³a vÃ  khÃ³a riÃªng Ä‘Æ°á»£c sá»­ dá»¥ng cho giáº£i mÃ£. Chá»‰ khÃ³a riÃªng cáº§n giá»¯ bÃ­ máº­t, cÃ²n khÃ³a cÃ´ng khai cÃ³ thá»ƒ phá»• biáº¿n rá»™ng rÃ£i, nhÆ°ng pháº£i Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n vÃ  xÃ¡c thá»±c chá»§ thá»ƒ cá»§a khÃ³a.

HÃ¬nh 3.27 minh há»a quÃ¡ trÃ¬nh mÃ£ hÃ³a (Encrypt) vÃ  giáº£i mÃ£ (Decrypt) sá»­ dá»¥ng mÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng. Theo Ä‘Ã³, ngÆ°á»i gá»­i (Sender) sá»­ dá»¥ng khÃ³a cÃ´ng khai (Public key) cá»§a ngÆ°á»i nháº­n (Recipient) Ä‘á»ƒ mÃ£ hÃ³a báº£n rÃµ (Plaintext) thÃ nh báº£n mÃ£ (Ciphertext) vÃ  gá»­i nÃ³ cho ngÆ°á»i nháº­n. NgÆ°á»i nháº­n nháº­n Ä‘Æ°á»£c báº£n mÃ£ sá»­ dá»¥ng khÃ³a riÃªng (Private key) cá»§a mÃ¬nh Ä‘á»ƒ giáº£i mÃ£ khÃ´i phá»¥c báº£n rÃµ.

Äáº·c Ä‘iá»ƒm ná»•i báº­t cá»§a cÃ¡c há»‡ mÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng lÃ  kÃ­ch thÆ°á»›c khÃ³a lá»›n, lÃªn Ä‘áº¿n hÃ ng ngÃ n bit. Do váº­y, cÃ¡c há»‡ mÃ£ hÃ³a dáº¡ng nÃ y thÆ°á»ng cÃ³ tá»‘c Ä‘á»™ thá»±c thi cháº­m hÆ¡n nhiá»u láº§n so vá»›i cÃ¡c há»‡ mÃ£ hÃ³a khÃ³a Ä‘á»‘i xá»©ng vá»›i Ä‘á»™ an toÃ n tÆ°Æ¡ng Ä‘Æ°Æ¡ng. Máº·c dÃ¹ váº­y, cÃ¡c há»‡ mÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng cÃ³ kháº£ nÄƒng Ä‘áº¡t Ä‘á»™ an toÃ n cao vÃ  Æ°u Ä‘iá»ƒm ná»•i báº­t nháº¥t lÃ  viá»‡c quáº£n lÃ½ vÃ  phÃ¢n phá»‘i khÃ³a Ä‘Æ¡n giáº£n hÆ¡n do khÃ³a cÃ´ng khai cÃ³ thá»ƒ phÃ¢n phá»‘i rá»™ng rÃ£i.

|<image_1>|

_HÃ¬nh 3.27. MÃ£ hÃ³a vÃ  giáº£i mÃ£ trong há»‡ mÃ£ hÃ³a báº¥t Ä‘á»‘i xá»©ng_

CÃ¡c giáº£i thuáº­t mÃ£ hÃ³a khÃ³a báº¥t Ä‘á»‘i xá»©ng Ä‘iá»ƒn hÃ¬nh bao gá»“m: RSA, Rabin, ElGamal, McEliece vÃ  Knapsack. Trong má»¥c tiáº¿p theo chÃºng ta tÃ¬m hiá»ƒu vá» giáº£i thuáº­t mÃ£ hÃ³a RSA â€“ má»™t trong cÃ¡c giáº£i thuáº­t mÃ£ hÃ³a khÃ³a Ä‘á»‘i xá»©ng Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nháº¥t trÃªn thá»±c táº¿.

## Giáº£i thuáº­t mÃ£ hÃ³a RSA

### Giá»›i thiá»‡u

Giáº£i thuáº­t mÃ£ hÃ³a RSA Ä‘Æ°á»£c 3 nhÃ  khoa há»c ngÆ°á»i Má»¹ lÃ  Ronald Rivest, Adi Shamir vÃ  Leonard Adleman phÃ¡t minh nÄƒm 1977, vÃ  tÃªn giáº£i thuáº­t RSA láº¥y theo chá»¯ cÃ¡i Ä‘áº§u cá»§a tÃªn 3 Ä‘á»“ng tÃ¡c giáº£. Äá»™ an toÃ n cá»§a RSA dá»±a trÃªn tÃ­nh khÃ³ cá»§a viá»‡c phÃ¢n tÃ­ch sá»‘ nguyÃªn ráº¥t lá»›n, vá»›i Ä‘á»™ lá»›n cá»¡ hÃ ng trÄƒm chá»¯ sá»‘ tháº­p phÃ¢n. Giáº£i thuáº­t RSA sá»­ dá»¥ng má»™t cáº·p khÃ³a, trong Ä‘Ã³ khÃ³a cÃ´ng khai dÃ¹ng Ä‘á»ƒ mÃ£ hÃ³a vÃ  khÃ³a riÃªng dÃ¹ng Ä‘á»ƒ giáº£i mÃ£. Chá»‰ khÃ³a riÃªng RSA cáº§n giá»¯ bÃ­ máº­t. KhÃ³a cÃ´ng khai cÃ³ thá»ƒ cÃ´ng bá»‘ rá»™ng rÃ£i. Hiá»‡n nay, cÃ¡c khÃ³a RSA cÃ³ kÃ­ch thÆ°á»›c nhá» hÆ¡n 1024 bit Ä‘Æ°á»£c coi lÃ  khÃ´ng an toÃ n do tá»‘c Ä‘á»™ cÃ¡c há»‡ thá»‘ng mÃ¡y tÃ­nh tÄƒng nhanh. Äá»ƒ Ä‘áº£m báº£o an toÃ n, khuyáº¿n nghá»‹ sá»­ dá»¥ng khÃ³a 2048 bit trong giai Ä‘oáº¡n 2010-2020. Trong tÆ°Æ¡ng lai, cáº§n sá»­ dá»¥ng khÃ³a RSA cÃ³ kÃ­ch thÆ°á»›c lá»›n hÆ¡n, cháº³ng háº¡n 3072 bit.

### Sinh khÃ³a

RSA cung cáº¥p má»™t thá»§ tá»¥c sinh cáº·p khÃ³a (khÃ³a cÃ´ng khai vÃ  khÃ³a riÃªng) tÆ°Æ¡ng Ä‘á»‘i Ä‘Æ¡n giáº£n. Cá»¥ thá»ƒ, thá»§ tá»¥c sinh khÃ³a gá»“m cÃ¡c bÆ°á»›c nhÆ° sau:

  * Táº¡o 2 sá»‘ nguyÃªn tá»‘ _p_ vÃ  _q_ ;

  * TÃ­nh modulo _n_ = _p_ Ã— _q_


\- TÃ­nh Î¦( _n_ ) = ( _p_ -1) Ã— ( _q_ -1)

  * Chá»n sá»‘ _e_ sao cho 0 < _e_ < Î¦( _n_ ) vÃ  gcd( _e_ , Î¦( _n_ )) = 1, trong Ä‘Ã³ hÃ m gcd() tÃ­nh Æ°á»›c sá»‘ chung lá»›n nháº¥t cá»§a 2 sá»‘ nguyÃªn. Náº¿u gcd( _e_ , Î¦( _n_ )) = 1 thÃ¬ _e_ vÃ  Î¦( _n_ ) lÃ  2 sá»‘ nguyÃªn tá»‘ cÃ¹ng nhau.

  * Chá»n sá»‘ _d_ sao cho _d_ â‰¡ _e_ -1 mod Î¦( _n_ ),


hoáº·c ( _d_ Ã— _e_ ) mod Î¦( _n_ ) = 1

hay _d_ lÃ  modulo nghá»‹ch Ä‘áº£o cá»§a _e_.

  * Ta cÃ³ ( _n_ , _e_ ) lÃ  khÃ³a cÃ´ng khai, ( _n_ , _d_ ) lÃ  khÃ³a riÃªng vÃ  _n_ cÃ²n Ä‘Æ°á»£c gá»i lÃ  modulo.


### MÃ£ hÃ³a vÃ  giáº£i mÃ£

  * MÃ£ hÃ³a


\+ ThÃ´ng Ä‘iá»‡p báº£n rÃµ _m_ Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn thÃ nh sá»‘, vá»›i _m_ < _n_. Náº¿u thÃ´ng Ä‘iá»‡p báº£n rÃµ _m_ cÃ³ kÃ­ch thÆ°á»›c lá»›n thÃ¬ Ä‘Æ°á»£c chia thÃ nh cÃ¡c khá»‘i _m i_, vá»›i _m i_ < _n_.

\+ Báº£n mÃ£ _c_ = _m e_ mod _n_

  * Giáº£i mÃ£


\+ Báº£n mÃ£ _c_ , vá»›i _c_ < _n_

\+ Báº£n rÃµ _m_ = _c d_ mod _n_

### VÃ­ dá»¥

  * Sinh khÃ³a:


\+ Chá»n 2 sá»‘ nguyÃªn tá»‘ _p_ = 3 vÃ  _q_ = 11

\+ TÃ­nh _n_ = _p_ Ã— q = 3 Ã— 11 = 33

\+ TÃ­nh Î¦( _n_ ) = ( _p_ -1) Ã— ( _q_ -1) = 2 Ã— 10 = 20

\+ Chá»n sá»‘ _e_ sao cho 0 < _e_ < 20, vÃ  _e_ vÃ  Î¦( _n_ ) lÃ  sá»‘ nguyÃªn tá»‘ cÃ¹ng nhau (Î¦( _n_ ) khÃ´ng chia háº¿t cho _e_ ). Chá»n _e_ = 7

\+ TÃ­nh ( _d_ x e) mod Î¦(n) ïƒ  ( _d_ Ã— 7) mod 20 = 1

_d_ = (20 Ã— _k_ +1)/7 ïƒ  _d_ = 3 ( _k_ =1)

\+ Ta cÃ³: khÃ³a cÃ´ng khai lÃ  (33, 7) vÃ  khÃ³a riÃªng lÃ  (33, 3)

  * MÃ£ hÃ³a:


\+ Vá»›i báº£n rÃµ _m_ = 6,

\+ _c_ = _m e_ mod _n_ = 67 mod 33 = 279936 mod 33 = 30

\+ Váº­y báº£n mÃ£ _c_ = 30

  * Giáº£i mÃ£:


\+ Vá»›i báº£n mÃ£ _c_ = 30

\+ _m_ = _c d_ mod _n_ = 303 mod 33 = 27000 mod 33 = 6

\+ Váº­y báº£n rÃµ _m_ = 6.

### Má»™t sá»‘ yÃªu cáº§u vá»›i quÃ¡ trÃ¬nh sinh khÃ³a

DÆ°á»›i Ä‘Ã¢y liá»‡t kÃª cÃ¡c yÃªu cáº§u Ä‘áº·t ra vá»›i cÃ¡c tham sá»‘ sinh khÃ³a vÃ  khÃ³a Ä‘á»ƒ Ä‘áº£m báº£o sá»± an toÃ n cho cáº·p khÃ³a RSA. CÃ¡c yÃªu cáº§u cá»¥ thá»ƒ gá»“m:

  * YÃªu cáº§u vá»›i cÃ¡c tham sá»‘ sinh khÃ³a _p_ vÃ  _q_ :


\+ CÃ¡c sá»‘ nguyÃªn tá»‘ _p_ vÃ  _q_ pháº£i Ä‘Æ°á»£c chá»n sao cho viá»‡c phÃ¢n tÃ­ch _n_ ( _n_ = _p_ Ã— _q_ ) lÃ  khÃ´ng kháº£ thi vá» máº·t tÃ­nh toÃ¡n. _p_ vÃ  _q_ nÃªn cÃ³ cÃ¹ng Ä‘á»™ lá»›n (tÃ­nh báº±ng bit) vÃ  pháº£i lÃ  cÃ¡c sá»‘ Ä‘á»§ lá»›n. Náº¿u _n_ cÃ³ kÃ­ch thÆ°á»›c 2048 bit thÃ¬ _p_ vÃ  _q_ nÃªn cÃ³ kÃ­ch thÆ°á»›c khoáº£ng 1024 bit.

\+ Hiá»‡u sá»‘ _p â€“ q_ khÃ´ng nÃªn quÃ¡ nhá», do náº¿u _p â€“ q_ quÃ¡ nhá», tá»©c _p_ â‰ˆ _q_ vÃ  _p_ â‰ˆ âˆš _ğ‘›_. NhÆ° váº­y, cÃ³ thá»ƒ chá»n cÃ¡c sá»‘ nguyÃªn tá»‘ á»Ÿ gáº§n âˆšğ‘› vÃ  thá»­. Khi cÃ³ Ä‘Æ°á»£c _p_ , cÃ³ thá»ƒ tÃ­nh _q_ vÃ  tÃ¬m ra _d_ lÃ  khÃ³a bÃ­ máº­t tá»« khÃ³a cÃ´ng khai _e_ vÃ  Î¦( _n_ ) = ( _p_ \- 1)( _q_ \- 1). Náº¿u _p_ vÃ  _q_ Ä‘Æ°á»£c chá»n ngáº«u nhiÃªn vÃ  _p_ â€“ _q_ Ä‘á»§ lá»›n, kháº£ nÄƒng hai sá»‘ nÃ y bá»‹ phÃ¢n tÃ­ch tá»« _n_ giáº£m Ä‘i.

  * Váº¥n Ä‘á» sá»­ dá»¥ng sá»‘ mÅ© mÃ£ hÃ³a ( _e_ ) nhá»: Khi sá»­ dá»¥ng sá»‘ mÅ© mÃ£ hÃ³a ( _e_ ) nhá», cháº³ng háº¡n


_e_ = 3 cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™ mÃ£ hÃ³a. Káº» táº¥n cÃ´ng cÃ³ thá»ƒ nghe lÃ©n vÃ  láº¥y Ä‘Æ°á»£c báº£n mÃ£, tá»« Ä‘Ã³ phÃ¢n tÃ­ch báº£n mÃ£ Ä‘á»ƒ khÃ´i phá»¥c báº£n rÃµ. Do sá»‘ mÅ© mÃ£ hÃ³a nhá» nÃªn chi phÃ­ cho phÃ¢n tÃ­ch, hoáº·c vÃ©t cáº¡n khÃ´ng quÃ¡ lá»›n. Do váº­y, nÃªn sá»­ dá»¥ng sá»‘ mÅ© mÃ£ hÃ³a _e_ Ä‘á»§ lá»›n vÃ  thÃªm chuá»—i ngáº«u nhiÃªn vÃ o khá»‘i rÃµ trÆ°á»›c khi mÃ£ hÃ³a Ä‘á»ƒ giáº£m kháº£ nÄƒng bá»‹ vÃ©t cáº¡n hoáº·c phÃ¢n tÃ­ch báº£n mÃ£.

  * Váº¥n Ä‘á» sá»­ dá»¥ng sá»‘ mÅ© giáº£i mÃ£ ( _d_ ) nhá»: Khi sá»­ dá»¥ng sá»‘ mÅ© giáº£i mÃ£ ( _d_ ) nhá», cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™ giáº£i mÃ£. Náº¿u _d_ nhá» vÃ  gcd( _p_ -1, _q_ -1) cÅ©ng nhá» thÃ¬ _d_ cÃ³ thá»ƒ tÃ­nh Ä‘Æ°á»£c tÆ°Æ¡ng Ä‘á»‘i dá»… dÃ ng tá»« khÃ³a cÃ´ng khai ( _n_ , _e_ ). Do váº­y, Ä‘á»ƒ Ä‘áº£m báº£o an toÃ n, nÃªn sá»­ dá»¥ng sá»‘ mÅ© giáº£i mÃ£ _d_ Ä‘á»§ lá»›n.


# CÃ¡c hÃ m bÄƒm

## KhÃ¡i quÃ¡t vá» hÃ m bÄƒm

### Giá»›i thiá»‡u

HÃ m bÄƒm (hash function) lÃ  má»™t hÃ m toÃ¡n há»c _h_ cÃ³ tá»‘i thiá»ƒu 2 thuá»™c tÃ­nh:

  * NÃ©n (Compression): _h_ lÃ  má»™t Ã¡nh xáº¡ tá»« chuá»—i Ä‘áº§u vÃ o _x_ cÃ³ chiá»u dÃ i báº¥t ká»³ sang má»™t chuá»—i Ä‘áº§u ra _h_ ( _x_ ) cÃ³ chiá»u dÃ i cá»‘ Ä‘á»‹nh _n_ bit;

  * Dá»… tÃ­nh toÃ¡n (Ease of computation): cho trÆ°á»›c hÃ m _h_ vÃ  Ä‘áº§u vÃ o _x_ , viá»‡c tÃ­nh toÃ¡n


_h_ ( _x_ ) lÃ  dá»… dÃ ng.

|<image_2>|

_HÃ¬nh 3.28. MÃ´ hÃ¬nh nÃ©n thÃ´ng tin cá»§a hÃ m bÄƒm_

HÃ¬nh 3.28 minh há»a mÃ´ hÃ¬nh nÃ©n thÃ´ng tin cá»§a hÃ m bÄƒm, theo Ä‘Ã³ thÃ´ng Ä‘iá»‡p (Message) Ä‘áº§u vÃ o vá»›i chiá»u dÃ i tÃ¹y Ã½ Ä‘i qua nhiá»u vÃ²ng xá»­ lÃ½ cá»§a hÃ m bÄƒm Ä‘á»ƒ táº¡o chuá»—i rÃºt gá»n, hay chuá»—i Ä‘áº¡i diá»‡n (Digest) cÃ³ kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh á»Ÿ Ä‘áº§u ra.

### PhÃ¢n loáº¡i

CÃ³ thá»ƒ phÃ¢n loáº¡i cÃ¡c hÃ m bÄƒm theo khÃ³a sá»­ dá»¥ng hoáº·c theo chá»©c nÄƒng. Theo khÃ³a sá»­ dá»¥ng, cÃ¡c hÃ m bÄƒm gá»“m 2 loáº¡i: hÃ m bÄƒm khÃ´ng khÃ³a (unkeyed) vÃ  hÃ m bÄƒm cÃ³ khÃ³a (keyed), nhÆ° biá»ƒu diá»…n trÃªn HÃ¬nh 3.29. Trong khi hÃ m bÄƒm khÃ´ng khÃ³a nháº­n Ä‘áº§u vÃ o chá»‰ lÃ  thÃ´ng Ä‘iá»‡p (dáº¡ng _h_ ( _x_ ), vá»›i hÃ m bÄƒm _h_ vÃ  thÃ´ng Ä‘iá»‡p _x_ ), hÃ m bÄƒm cÃ³ khÃ³a nháº­n Ä‘áº§u vÃ o gá»“m thÃ´ng Ä‘iá»‡p vÃ  khÃ³a bÃ­ máº­t (theo dáº¡ng _h_ ( _x_ , _K_ ), vá»›i hÃ m bÄƒm _h_ vÃ  thÃ´ng Ä‘iá»‡p _x_ vÃ  _K_ lÃ  khÃ³a bÃ­ máº­t). Trong cÃ¡c hÃ m bÄƒm khÃ´ng khÃ³a, cÃ¡c mÃ£ phÃ¡t hiá»‡n sá»­a Ä‘á»•i (MDC â€“ Modification Detection Code) Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nháº¥t, bÃªn cáº¡nh má»™t sá»‘ hÃ m bÄƒm khÃ´ng khÃ³a khÃ¡c. TÆ°Æ¡ng tá»±, trong cÃ¡c hÃ m bÄƒm cÃ³ khÃ³a, cÃ¡c mÃ£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p (MAC - Message Authentication Code) Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nháº¥t, bÃªn cáº¡nh má»™t sá»‘ hÃ m bÄƒm cÃ³ khÃ³a khÃ¡c.

|<image_3>|

_HÃ¬nh 3.29. PhÃ¢n loáº¡i cÃ¡c hÃ m bÄƒm theo khÃ³a sá»­ dá»¥ng_

Theo chá»©c nÄƒng, cÃ³ thá»ƒ chia cÃ¡c hÃ m bÄƒm thÃ nh 2 loáº¡i chÃ­nh:

  * MÃ£ phÃ¡t hiá»‡n sá»­a Ä‘á»•i (MDC - Modification Detection Code): MDC thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o chuá»—i Ä‘áº¡i diá»‡n cho thÃ´ng Ä‘iá»‡p vÃ  dÃ¹ng káº¿t há»£p vá»›i cÃ¡c ká»¹ thuáº­t khÃ¡c (nhÆ° chá»¯ kÃ½ sá»‘) Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n cá»§a thÃ´ng Ä‘iá»‡p. MDC thuá»™c loáº¡i hÃ m bÄƒm khÃ´ng khÃ³a. MDC gá»“m 2 loáº¡i nhá»:


\+ HÃ m bÄƒm má»™t chiá»u (OWHF - One-way hash functions): Vá»›i hÃ m bÄƒm má»™t chiá»u, viá»‡c tÃ­nh giÃ¡ trá»‹ bÄƒm lÃ  dá»… dÃ ng, nhÆ°ng viá»‡c khÃ´i phá»¥c thÃ´ng Ä‘iá»‡p tá»« giÃ¡ trá»‹ bÄƒm lÃ  ráº¥t khÃ³ khÄƒn;

\+ HÃ m bÄƒm chá»‘ng Ä‘á»¥ng Ä‘á»™ (CRHF - Collision resistant hash functions): Vá»›i hÃ m bÄƒm chá»‘ng Ä‘á»¥ng Ä‘á»™, sáº½ lÃ  ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c 2 thÃ´ng Ä‘iá»‡p khÃ¡c nhau nhÆ°ng cÃ³ cÃ¹ng giÃ¡ trá»‹ bÄƒm.

  * MÃ£ xÃ¡c thá»±c thÃ´ng Ä‘iá»‡p (MAC - Message Authentication Code): MAC cÅ©ng Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n cá»§a thÃ´ng Ä‘iá»‡p mÃ  khÃ´ng cáº§n má»™t ká»¹ thuáº­t bá»• sung nÃ o khÃ¡c. MAC lÃ  loáº¡i hÃ m bÄƒm cÃ³ khÃ³a nhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ trÃªn, vá»›i Ä‘áº§u vÃ o lÃ  thÃ´ng Ä‘iá»‡p vÃ  má»™t khÃ³a bÃ­ máº­t.


### MÃ´ hÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u

HÃ¬nh 3.30 biá»ƒu diá»…n mÃ´ hÃ¬nh tá»•ng quÃ¡t xá»­ lÃ½ dá»¯ liá»‡u cá»§a cÃ¡c hÃ m bÄƒm. Theo Ä‘Ã³, thÃ´ng Ä‘iá»‡p Ä‘áº§u vÃ o vá»›i Ä‘á»™ dÃ i tÃ¹y Ã½ (arbitrary length input) Ä‘i qua hÃ m nÃ©n láº·p nhiá»u vÃ²ng (iterated compression function) Ä‘á»ƒ táº¡o chuá»—i Ä‘áº§u ra cÃ³ kÃ­ch thÆ°á»›c cá»‘ Ä‘á»‹nh (fixed length output). Chuá»—i nÃ y Ä‘i qua má»™t khÃ¢u chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng tÃ¹y chá»n (optional output transformation) Ä‘á»ƒ táº¡o ra chuá»—i bÄƒm káº¿t quáº£ (output).

|<image_4>|

_HÃ¬nh 3.30. MÃ´ hÃ¬nh tá»•ng quÃ¡t xá»­ lÃ½ dá»¯ liá»‡u cá»§a hÃ m bÄƒm_

HÃ¬nh 3.31 mÃ´ táº£ chi tiáº¿t quÃ¡ trÃ¬nh xá»­ lÃ½ dá»¯ liá»‡u cá»§a cÃ¡c hÃ m bÄƒm. Theo Ä‘Ã³, quÃ¡ trÃ¬nh xá»­ lÃ½ gá»“m 3 bÆ°á»›c chÃ­nh: (1) tiá»n xá»­ lÃ½ (preprocessing), (2) xá»­ lÃ½ láº·p (iterated processing) vÃ  (3) chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng. Trong bÆ°á»›c tiá»n xá»­ lÃ½, thÃ´ng Ä‘iá»‡p Ä‘áº§u vÃ o _x_ trÆ°á»›c háº¿t Ä‘Æ°á»£c ná»‘i Ä‘uÃ´i thÃªm má»™t sá»‘ bit vÃ  kÃ­ch thÆ°á»›c khá»‘i, sau Ä‘Ã³ chia thÃ nh cÃ¡c khá»‘i cÃ³ kÃ­ch thÆ°á»›c xÃ¡c Ä‘á»‹nh. Káº¿t quáº£ cá»§a bÆ°á»›c nÃ y lÃ  _t_ khá»‘i dá»¯ liá»‡u cÃ³ cÃ¹ng kÃ­ch thÆ°á»›c cÃ³ dáº¡ng _x_ = _x 1x2â€¦xt_ lÃ m Ä‘áº§u vÃ o cho bÆ°á»›c 2\. Trong bÆ°á»›c 2, tá»«ng khá»‘i dá»¯ liá»‡u _x i_ Ä‘Æ°á»£c xá»­ lÃ½ thÃ´ng qua hÃ m nÃ©n _f_

Ä‘á»ƒ táº¡o Ä‘áº§u ra lÃ  _H i_. Káº¿t quáº£ cá»§a bÆ°á»›c 2 lÃ  chuá»—i Ä‘áº§u ra _H t_ vÃ  _H t_ Ä‘Æ°á»£c chuyá»ƒn Ä‘á»•i Ä‘á»‹nh dáº¡ng bá»Ÿi hÃ m _g_ Ä‘á»ƒ táº¡o chuá»—i giÃ¡ trá»‹ bÄƒm háº¿t quáº£ _h_ ( _x_ ).

|<image_5>|

_HÃ¬nh 3.31. MÃ´ hÃ¬nh chi tiáº¿t xá»­ lÃ½ dá»¯ liá»‡u cá»§a hÃ m bÄƒm_

## Má»™t sá»‘ hÃ m bÄƒm thÃ´ng dá»¥ng

CÃ¡c hÃ m bÄƒm thÃ´ng dá»¥ng giá»›i thiá»‡u trong má»¥c nÃ y Ä‘á»u lÃ  cÃ¡c hÃ m bÄƒm khÃ´ng khÃ³a, gá»“m cÃ¡c há» hÃ m bÄƒm chÃ­nh nhÆ° sau:

  * Há» hÃ m bÄƒm MD (Message Digest) gá»“m cÃ¡c hÃ m bÄƒm MD2, MD4, MD5 vÃ  MD6.

  * Há» hÃ m bÄƒm SHA (Secure Hash Algorithm) gá»“m cÃ¡c hÃ m bÄƒm SHA0, SHA1, SHA2 vÃ  SHA3.

  * Má»™t sá»‘ hÃ m bÄƒm khÃ¡c, gá»“m CRC (Cyclic redundancy checks), Checksums,...


CÃ¡c má»¥c con tiáº¿p theo cá»§a má»¥c nÃ y giá»›i thiá»‡u 2 hÃ m bÄƒm Ä‘Ã£ vÃ  Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i nháº¥t lÃ  hÃ m bÄƒm MD5 vÃ  SHA1.

### HÃ m bÄƒm MD5

  * Giá»›i thiá»‡u


MD5 (Message Digest) lÃ  hÃ m bÄƒm khÃ´ng khÃ³a Ä‘Æ°á»£c Ronald Rivest thiáº¿t káº¿ nÄƒm 1991 Ä‘á»ƒ thay tháº¿ MD4. Chuá»—i giÃ¡ trá»‹ bÄƒm Ä‘áº§u ra cá»§a MD5 lÃ  128 bit (16 byte) vÃ  thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n thÃ nh 32 sá»‘ hexa. MD5 Ä‘Æ°á»£c sá»­ dá»¥ng khÃ¡ rá»™ng rÃ£i trong nhiá»u á»©ng dá»¥ng, nhÆ° táº¡o chuá»—i Ä‘áº£m báº£o tÃ­nh toÃ n váº¹n thÃ´ng Ä‘iá»‡p, táº¡o chuá»—i kiá»ƒm tra lá»—i, hoáº·c kiá»ƒm tra tÃ­nh toÃ n váº¹n dá»¯ liá»‡u (Checksum) vÃ  mÃ£ hÃ³a máº­t kháº©u trong cÃ¡c há»‡ Ä‘iá»u hÃ nh vÃ  cÃ¡c á»©ng dá»¥ng. MD5 hiá»‡n nay Ä‘Æ°á»£c khuyáº¿n nghá»‹ khÃ´ng nÃªn sá»­ dá»¥ng do nÃ³ khÃ´ng cÃ²n Ä‘á»§ an toÃ n.

Nhiá»u Ä‘iá»ƒm yáº¿u cá»§a MD5 Ä‘Ã£ bá»‹ khai thÃ¡c, nhÆ° Ä‘iá»ƒn hÃ¬nh MD5 bá»‹ khai thÃ¡c bá»Ÿi mÃ£ Ä‘á»™c Flame vÃ o nÄƒm 2012.

  * QuÃ¡ trÃ¬nh xá»­ lÃ½ thÃ´ng Ä‘iá»‡p


QuÃ¡ trÃ¬nh xá»­ lÃ½ thÃ´ng Ä‘iá»‡p cá»§a MD5 gá»“m 2 khÃ¢u lÃ  _tiá»n xá»­ lÃ½_ vÃ  _cÃ¡c vÃ²ng láº·p xá»­ lÃ½_.

Cá»¥ thá»ƒ, chi tiáº¿t vá» cÃ¡c khÃ¢u nÃ y nhÆ° sau:

  * Tiá»n xá»­ lÃ½: ThÃ´ng Ä‘iá»‡p Ä‘Æ°á»£c chia thÃ nh cÃ¡c khá»‘i 512 bit (16 tá»« 32 bit). Náº¿u kÃ­ch thÆ°á»›c thÃ´ng Ä‘iá»‡p khÃ´ng lÃ  bá»™i sá»‘ cá»§a 512 thÃ¬ ná»‘i thÃªm sá»‘ bit cÃ²n thiáº¿u.

  * CÃ¡c vÃ²ng láº·p xá»­ lÃ½: Pháº§n xá»­ lÃ½ chÃ­nh cá»§a MD5 lÃ m viá»‡c trÃªn _state_ 128 bit, chia thÃ nh 4 tá»« 32 bit (A, B, C, D):


\+ CÃ¡c tá»« A, B, C, D Ä‘Æ°á»£c khá»Ÿi trá»‹ báº±ng má»™t háº±ng cá»‘ Ä‘á»‹nh;

\+ Tá»«ng pháº§n 32 bit cá»§a khá»‘i Ä‘áº§u vÃ o 512 bit Ä‘Æ°á»£c Ä‘Æ°a dáº§n vÃ o Ä‘á»ƒ thay Ä‘á»•i _state_ ;

\+ QuÃ¡ trÃ¬nh xá»­ lÃ½ gá»“m 4 vÃ²ng, má»—i vÃ²ng gá»“m 16 thao tÃ¡c tÆ°Æ¡ng tá»± nhau.

\+ Má»—i thao tÃ¡c gá»“m: Xá»­ lÃ½ bá»Ÿi hÃ m F (4 dáº¡ng hÃ m khÃ¡c nhau cho má»—i vÃ²ng), Cá»™ng modulo vÃ  Quay trÃ¡i. HÃ¬nh 3.32 biá»ƒu diá»…n lÆ°u Ä‘á»“ xá»­ lÃ½ cá»§a má»™t thao tÃ¡c cá»§a MD5, trong Ä‘Ã³ A, B, C, D lÃ  cÃ¡c tá»« 32 bit cá»§a _state_ , Mi: khá»‘i 32 bit thÃ´ng Ä‘iá»‡p Ä‘áº§u vÃ o, Ki lÃ  32 bit háº±ng khÃ¡c nhau cho má»—i thao tÃ¡c, <<<s lÃ  thao tÃ¡c dá»‹ch trÃ¡i _s_ bit, |<image_6>| biá»ƒu diá»…n phÃ©p cá»™ng modulo 32 bit vÃ  F lÃ  hÃ m phi tuyáº¿n tÃ­nh.

|<image_7>|

_HÃ¬nh 3.32. LÆ°u Ä‘á»“ xá»­ lÃ½ má»™t thao tÃ¡c cá»§a MD5_

HÃ m F gá»“m 4 dáº¡ng Ä‘Æ°á»£c dÃ¹ng cho 4 vÃ²ng láº·p. Cá»¥ thá»ƒ, F cÃ³ cÃ¡c dáº¡ng nhÆ° sau: F(B, C, D) = (B âˆ§ C) âˆ¨ (Â¬B âˆ§ D)

G(B, C, D) = (B âˆ§ D) âˆ¨ (C âˆ§ Â¬D) H(B, C, D) = B âŠ• C âŠ• D

I(B, C, D) = C âŠ• (B âˆ¨ Â¬D)

trong Ä‘Ã³, cÃ¡c kÃ½ hiá»‡u âŠ•, âˆ§, âˆ¨, Â¬ biá»ƒu diá»…n cÃ¡c phÃ©p toÃ¡n lÃ´ gÃ­c XOR, AND, OR vÃ  NOT tÆ°Æ¡ng á»©ng.

### HÃ m bÄƒm SHA1

  * Giá»›i thiá»‡u


SHA1 (Secure Hash Function) Ä‘Æ°á»£c CÆ¡ quan máº­t vá»¥ Má»¹ thiáº¿t káº¿ nÄƒm 1995 Ä‘á»ƒ thay tháº¿ cho hÃ m bÄƒm SHA0. Chuá»—i giÃ¡ trá»‹ bÄƒm Ä‘áº§u ra cá»§a SHA1 cÃ³ kÃ­ch thÆ°á»›c 160 bit vÃ  thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n thÃ nh 40 sá»‘ hexa. TÆ°Æ¡ng tá»± MD5, SHA1 Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh xÃ¡c thá»±c vÃ  toÃ n váº¹n thÃ´ng Ä‘iá»‡p.

  * QuÃ¡ trÃ¬nh xá»­ lÃ½ thÃ´ng Ä‘iá»‡p


SHA1 sá»­ dá»¥ng thá»§ tá»¥c xá»­ lÃ½ thÃ´ng Ä‘iá»‡p tÆ°Æ¡ng tá»± MD5, cÅ©ng gá»“m 2 khÃ¢u lÃ  _tiá»n xá»­ lÃ½_

vÃ  _cÃ¡c vÃ²ng láº·p xá»­ lÃ½_. Cá»¥ thá»ƒ, chi tiáº¿t vá» cÃ¡c khÃ¢u nÃ y nhÆ° sau:

  * Tiá»n xá»­ lÃ½: ThÃ´ng Ä‘iá»‡p Ä‘Æ°á»£c chia thÃ nh cÃ¡c khá»‘i 512 bit (16 tá»« 32 bit). Náº¿u kÃ­ch thÆ°á»›c thÃ´ng Ä‘iá»‡p khÃ´ng lÃ  bá»™i sá»‘ cá»§a 512 thÃ¬ ná»‘i thÃªm sá»‘ bit cÃ²n thiáº¿u.

  * CÃ¡c vÃ²ng láº·p xá»­ lÃ½: Pháº§n xá»­ lÃ½ chÃ­nh cá»§a SHA1 lÃ m viá»‡c trÃªn _state_ 160 bit, chia thÃ nh 5 tá»« 32 bit (A, B, C, D, E):


\+ CÃ¡c tá»« A, B, C, D, E Ä‘Æ°á»£c khá»Ÿi trá»‹ báº±ng má»™t háº±ng cá»‘ Ä‘á»‹nh;

\+ Tá»«ng pháº§n 32 bit cá»§a khá»‘i Ä‘áº§u vÃ o 512 bit Ä‘Æ°á»£c Ä‘Æ°a dáº§n vÃ o Ä‘á»ƒ thay Ä‘á»•i _state_ ;

\+ QuÃ¡ trÃ¬nh xá»­ lÃ½ gá»“m 80 vÃ²ng, má»—i vÃ²ng gá»“m cÃ¡c thao tÃ¡c: add, and, or, xor, rotate, mod.

\+ Má»—i vÃ²ng xá»­ lÃ½ gá»“m: Xá»­ lÃ½ bá»Ÿi hÃ m phi tuyáº¿n tÃ­nh F (cÃ³ nhiá»u dáº¡ng hÃ m khÃ¡c nhau), Cá»™ng modulo vÃ  Quay trÃ¡i. HÃ¬nh 3.33 biá»ƒu diá»…n lÆ°u Ä‘á»“ má»™t vÃ²ng xá»­ lÃ½ cá»§a SHA1, trong Ä‘Ã³ A, B, C, D, E lÃ  cÃ¡c tá»« 32 bit cá»§a _state_ , Wt: khá»‘i 32 bit thÃ´ng Ä‘iá»‡p Ä‘áº§u vÃ o, Kt lÃ  32 bit háº±ng khÃ¡c nhau cho má»—i vÃ²ng, <<<n lÃ  thao tÃ¡c dá»‹ch trÃ¡i _n_ bit, |<image_8>| biá»ƒu diá»…n phÃ©p cá»™ng modulo 32 bit vÃ  F lÃ  hÃ m phi tuyáº¿n tÃ­nh.

|<image_9>|

_HÃ¬nh 3.33. LÆ°u Ä‘á»“ má»™t vÃ²ng xá»­ lÃ½ cá»§a SHA1_